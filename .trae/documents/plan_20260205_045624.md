I will upgrade the AI to understand chat history and allow editing of knowledge items.

### **Plan**

1.  **Context-Aware AI (`server/src/services/ai.js` & `whatsapp.js`)**:
    -   Update `generateResponse` to accept `remoteJid`.
    -   Query the `chats` table for the last 3 days of messages for that specific user.
    -   Format these messages (User/Assistant) and prepend them to the prompt sent to OpenAI.
    -   This ensures the AI "remembers" recent context like a human would.

2.  **Edit Knowledge Functionality**:
    -   **Backend (`server/src/routes.js`)**: Add a `PUT /api/knowledge/:id` endpoint to update content and re-generate the vector embedding.
    -   **Frontend (`client/src/pages/KnowledgeBase.jsx`)**:
        -   Add an **Edit Button** (Pencil Icon) to each knowledge item.
        -   When clicked, populate the "Add Knowledge" text area with the existing content and change the button to "Update".
        -   Handle the update logic to save changes.

### **Technical Details**
-   **History Query**: `SELECT role, message FROM chats WHERE remote_jid = ? AND timestamp > datetime('now', '-3 days') ORDER BY timestamp ASC`
-   **Token Management**: The history will be limited (e.g., last 10-20 messages) to prevent hitting token limits too quickly.
